<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Draggable Pin on Website Content</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* ----------------------------------------
       Section 2 Container (“Draggable Area”)
    ---------------------------------------- */
    #draggableContainer {
      position: relative;
      width: 90%;
      max-width: 800px;
      background-color: #0D0D0D;
      padding: 90px;
      box-sizing: border-box;
      min-height: 500px;
      z-index: 1;
    }

    /* ----------------------------------------
       Draggable Pin Wrapper
    ---------------------------------------- */
    #draggablePinWrapper {
      position: absolute;
      cursor: grab;
      touch-action: none;
      transition: transform 0.3s ease-in-out;
      z-index: 100;
    }
    #draggablePinWrapper.dragging {
      cursor: grabbing;
      transition: none;
    }
    #draggablePinWrapper img {
      pointer-events: none;
      filter: drop-shadow(0 0 10px rgba(0,123,255,0.8));
    }
  </style>
</head>

<body class="bg-[#0D0D0D] text-white min-h-screen overflow-x-hidden font-sans antialiased">
  <!-- =================================
       SECTION 1 (Dummy content above)
       ================================= -->
  <section class="metabrain relative min-h-[1700px] overflow-hidden pt-32">
    <!-- SECTION 2: Draggable Container -->
    <div
      id="draggableContainer"
      class="relative md:absolute md:top-[1px] md:left-[360px] md:text-left text-80 text-center w-full md:w-auto overflow-visible pt-32"
    >
      <h1
        class="text-4xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-500 via-red-500 to-pink-500"
      >
        Knowledge at
        <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-500 via-red-500 to-pink-500"
        >
          Fingertips
        </span>
      </h1>

      <p
        id="snap-target-row"
        class="max-w-xl mx-auto md:mx-0 mb-20"
        style="color: #A0A0A0;"
      >
        Huly offers a wide range of features to create and manage your project
        documentation. Huly’s suite of collaborative editing tools boosts team
        efficiency.
      </p>

      <div id="main-wrapper">
        <div
          id="draggablePinWrapper"
          class="absolute flex flex-col items-start cursor-grab active:cursor-grabbing select-none float-pin md:top-[20px] md:left-[100px]"
          style="left: 1px; top: -20px;"
        >
          <div class="relative w-[66px] h-[66px]">
            <img
              id="draggablebox"
              src="blue-pin.png"
              alt="pin"
              class="relative w-full h-full object-contain pointer-events-none"
            />
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- =================================
       JAVASCRIPT: Horizontal Drag + Snap to Top of Paragraph
       ================================= -->
  <script>
    const draggableBox       = document.getElementById('draggablePinWrapper');
    const draggableContainer = document.getElementById('draggableContainer');
    const snapTargetRow      = document.getElementById('snap-target-row');

    let isDragging = false;
    let offsetX = 0, offsetY = 0;

    function getRect(el) {
      return el.getBoundingClientRect();
    }

    // Snap so that the pin’s TOP aligns with the top of #snap-target-row
    function snapToTargetTop() {
      const containerRect = getRect(draggableContainer);
      const boxRect       = getRect(draggableBox);
      const targetRect    = getRect(snapTargetRow);

      // Compute targetY relative to container:
      // (targetRect.top – containerRect.top)
      const targetY = targetRect.top - containerRect.top;

      // Read current transform X (if any)
      const matrix = new WebKitCSSMatrix(
        window.getComputedStyle(draggableBox).transform
      );
      let currentX = matrix.m41;

      // Clamp X within [0, containerWidth - boxWidth]
      const minX = 0;
      const maxX = containerRect.width - boxRect.width;
      currentX = Math.max(minX, Math.min(currentX, maxX));

      // Apply smooth snap to (currentX, targetY)
      draggableBox.style.transition = 'transform 0.4s ease-in-out';
      draggableBox.style.transform  = `translate(${currentX}px, ${targetY}px)`;

      // After snap completes, restore quick transition
      setTimeout(() => {
        draggableBox.style.transition = 'transform 0.06s linear';
      }, 400);
    }

    draggableBox.addEventListener('mousedown', (e) => {
      isDragging = true;
      draggableBox.classList.add('dragging');
      draggableBox.style.transition = 'transform 0.06s linear';

      const boxRect = getRect(draggableBox);
      offsetX = e.clientX - boxRect.left;
      offsetY = e.clientY - boxRect.top;
    });

    draggableContainer.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      const containerRect = getRect(draggableContainer);

      let newX = e.clientX - offsetX - containerRect.left;
      let newY = e.clientY - offsetY - containerRect.top;

      // Clamp horizontally inside container
      const boxRect = getRect(draggableBox);
      newX = Math.max(0, Math.min(newX, containerRect.width - boxRect.width));

      draggableBox.style.transform = `translate(${newX}px, ${newY}px)`;
    });

    draggableContainer.addEventListener('mouseup', () => {
      if (!isDragging) return;
      isDragging = false;
      draggableBox.classList.remove('dragging');
      snapToTargetTop();
    });

    // Touch support
    draggableBox.addEventListener('touchstart', (e) => {
      isDragging = true;
      draggableBox.classList.add('dragging');
      draggableBox.style.transition = 'transform 0.06s linear';
      const touch   = e.touches[0];
      const boxRect = getRect(draggableBox);

      offsetX = touch.clientX - boxRect.left;
      offsetY = touch.clientY - boxRect.top;
      e.preventDefault();
    });

    draggableContainer.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      e.preventDefault();
      const touch         = e.touches[0];
      const containerRect = getRect(draggableContainer);

      let newX = touch.clientX - offsetX - containerRect.left;
      let newY = touch.clientY - offsetY - containerRect.top;

      const boxRect = getRect(draggableBox);
      newX = Math.max(0, Math.min(newX, containerRect.width - boxRect.width));

      draggableBox.style.transform = `translate(${newX}px, ${newY}px)`;
    });

    draggableContainer.addEventListener('touchend', () => {
      if (!isDragging) return;
      isDragging = false;
      draggableBox.classList.remove('dragging');
      snapToTargetTop();
    });

    window.addEventListener('load', snapToTargetTop);
    window.addEventListener('resize', snapToTargetTop);
  </script>
</body>
</html>
