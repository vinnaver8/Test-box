<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Floating Snap Button</title>
  <style>
    * {
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }
    #main-wrapper {
      position: relative;
      width: 100%;
      height: 100vh;
      background-color: #E1E8FD;
      overflow: hidden;
    }
    #floating-snap-btn-wrapper {
      position: absolute;
      top: 40%;
      left: 30px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      transition: all 0.3s ease-in-out;
    }
    #floating-snap-btn-wrapper .fab-btn {
      position: absolute;
      top: 0; left: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%; height: 100%;
      border-radius: 50%;
      background-color: #6B26BB;
      color: white;
      z-index: 1000;
      box-shadow: 0px 2px 17px -1px rgba(0,0,0,0.3);
      cursor: grab;
    }
    #floating-snap-btn-wrapper ul {
      position: relative;
      width: 100%; height: 100%;
      list-style: none;
    }
    #floating-snap-btn-wrapper ul li {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f7f7f7;
      color: black;
      transform: scale(0.95);
      transition: .5s;
      border-radius: 50%;
    }
    #floating-snap-btn-wrapper.fab-active li:hover {
      background-color: #f8e487;
    }
    /* horizontal expand */
    #floating-snap-btn-wrapper.left li:nth-child(1) { top:0; left:300%; transition-delay:0s }
    #floating-snap-btn-wrapper.left li:nth-child(2) { top:0; left:200%; transition-delay:0.2s }
    #floating-snap-btn-wrapper.left li:nth-child(3) { top:0; left:100%; transition-delay:0.4s }
    #floating-snap-btn-wrapper.right li:nth-child(1){ top:0; left:-300%; transition-delay:0s }
    #floating-snap-btn-wrapper.right li:nth-child(2){ top:0; left:-200%; transition-delay:0.2s }
    #floating-snap-btn-wrapper.right li:nth-child(3){ top:0; left:-100%; transition-delay:0.4s }
  </style>
</head>
<body>
  <div id="main-wrapper">
    <div id="floating-snap-btn-wrapper">
      <div class="fab-btn">
        <ion-icon name="share-social"></ion-icon>
      </div>
      <ul>
        <li><ion-icon name="logo-twitter"></ion-icon></li>
        <li><ion-icon name="logo-facebook"></ion-icon></li>
        <li><ion-icon name="logo-whatsapp"></ion-icon></li>
      </ul>
    </div>
  </div>

  <script>
    const fab = document.getElementById("floating-snap-btn-wrapper");
    const wrapper = document.getElementById("main-wrapper");
    let isDragging = false;
    let offset = { x: 0, y: 0 };

    fab.addEventListener("mousedown", startDrag);
    fab.addEventListener("touchstart", startDrag);

    document.addEventListener("mousemove", onMove);
    document.addEventListener("touchmove", onMove);

    document.addEventListener("mouseup", endDrag);
    document.addEventListener("touchend", endDrag);

    fab.addEventListener("click", (e) => {
      // only toggle expand if it wasn't moved
      if (!fab.classList.contains("moved")) {
        fab.classList.toggle("fab-active");
      }
      fab.classList.remove("moved");
    });

    function startDrag(e) {
      isDragging = true;
      fab.classList.remove("fab-active"); // collapse if open
      fab.style.transition = "none";
      const clientX = e.type === "touchstart" ? e.touches[0].clientX : e.clientX;
      const clientY = e.type === "touchstart" ? e.touches[0].clientY : e.clientY;
      offset.x = clientX - fab.offsetLeft;
      offset.y = clientY - fab.offsetTop;
    }

    function onMove(e) {
      if (!isDragging) return;
      e.preventDefault();
      const clientX = e.type === "touchmove" ? e.touches[0].clientX : e.clientX;
      const clientY = e.type === "touchmove" ? e.touches[0].clientY : e.clientY;
      fab.style.left = (clientX - offset.x) + "px";
      fab.style.top  = (clientY - offset.y) + "px";
      fab.classList.add("moved");
    }

    function endDrag(e) {
      if (!isDragging) return;
      isDragging = false;
      fab.style.transition = "all 0.3s ease-in-out";

      // clamp inside wrapper
      const wrapRect = wrapper.getBoundingClientRect();
      const fabRect  = fab.getBoundingClientRect();
      let x = fabRect.left - wrapRect.left;
      let y = fabRect.top  - wrapRect.top;
      x = Math.max(0, Math.min(x, wrapRect.width  - fabRect.width));
      y = Math.max(0, Math.min(y, wrapRect.height - fabRect.height));
      fab.style.left = x + "px";
      fab.style.top  = y + "px";

      // distances to edges
      const dist = {
        left:   x,
        right:  wrapRect.width  - x - fabRect.width,
        top:    y,
        bottom: wrapRect.height - y - fabRect.height
      };
      const nearest = Object.entries(dist).reduce((prev,[k,v]) => v < prev[1] ? [k,v] : prev, ["left", Infinity])[0];

      // snap to nearest
      switch(nearest) {
        case "left":
          fab.style.left = "30px";
          fab.classList.add("left");
          fab.classList.remove("right");
          break;
        case "right":
          fab.style.left = (wrapRect.width - 30 - fabRect.width) + "px";
          fab.classList.add("right");
          fab.classList.remove("left");
          break;
        case "top":
          fab.style.top  = "30px";
          break;
        case "bottom":
          fab.style.top  = (wrapRect.height - 30 - fabRect.height) + "px";
          break;
      }
    }
  </script>
</body>
</html>
